<?xml version="1.0" encoding="UTF-8"?>
<pipeline>
  <info>
    <name>cameroon_dhis2_template_simplified</name>
    <name_sync_with_filename>Y</name_sync_with_filename>
    <description/>
    <extended_description/>
    <pipeline_version/>
    <pipeline_type>Normal</pipeline_type>
    <parameters>
    </parameters>
    <capture_transform_performance>N</capture_transform_performance>
    <transform_performance_capturing_delay>1000</transform_performance_capturing_delay>
    <transform_performance_capturing_size_limit>100</transform_performance_capturing_size_limit>
    <created_user>Speedykom</created_user>
    <created_date>2022/03/09 08:35:58.984</created_date>
    <modified_user>-</modified_user>
    <modified_date>2022/03/09 08:35:58.984</modified_date>
  </info>
  <notepads>
    <notepad>
      <backgroundcolorblue>251</backgroundcolorblue>
      <backgroundcolorgreen>232</backgroundcolorgreen>
      <backgroundcolorred>201</backgroundcolorred>
      <bordercolorblue>90</bordercolorblue>
      <bordercolorgreen>58</bordercolorgreen>
      <bordercolorred>14</bordercolorred>
      <fontbold>N</fontbold>
      <fontcolorblue>90</fontcolorblue>
      <fontcolorgreen>58</fontcolorgreen>
      <fontcolorred>14</fontcolorred>
      <fontitalic>N</fontitalic>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <height>58</height>
      <xloc>0</xloc>
      <yloc>272</yloc>
      <note>ids needs to be provided by the user by searching for 
dataElemens in this api
https://dhis-minsante-cm.org/api/dataElements.json?paging=false</note>
      <width>410</width>
    </notepad>
    <notepad>
      <backgroundcolorblue>251</backgroundcolorblue>
      <backgroundcolorgreen>232</backgroundcolorgreen>
      <backgroundcolorred>201</backgroundcolorred>
      <bordercolorblue>90</bordercolorblue>
      <bordercolorgreen>58</bordercolorgreen>
      <bordercolorred>14</bordercolorred>
      <fontbold>N</fontbold>
      <fontcolorblue>90</fontcolorblue>
      <fontcolorgreen>58</fontcolorgreen>
      <fontcolorred>14</fontcolorred>
      <fontitalic>N</fontitalic>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <height>106</height>
      <xloc>32</xloc>
      <yloc>48</yloc>
      <note>Please provide the organization 
level you want to use depending 
on the country possible values are: 
1, 2, 3, 4, 5
Level-1 means the highest organization
unit (country)</note>
      <width>247</width>
    </notepad>
    <notepad>
      <backgroundcolorblue>251</backgroundcolorblue>
      <backgroundcolorgreen>232</backgroundcolorgreen>
      <backgroundcolorred>201</backgroundcolorred>
      <bordercolorblue>90</bordercolorblue>
      <bordercolorgreen>58</bordercolorgreen>
      <bordercolorred>14</bordercolorred>
      <fontbold>N</fontbold>
      <fontcolorblue>90</fontcolorblue>
      <fontcolorgreen>58</fontcolorgreen>
      <fontcolorred>14</fontcolorred>
      <fontitalic>N</fontitalic>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <height>154</height>
      <xloc>0</xloc>
      <yloc>544</yloc>
      <note>Supported values:
THIS_WEEK, LAST_WEEK, LAST_4_WEEKS, 
LAST_12_WEEKS, LAST_52_WEEKS, WEEKS_THIS_YEAR

THIS_MONTH, LAST_MONTH, LAST_3_MONTHS, 
LAST_6_MONTHS, LAST_12_MONTHS, MONTHS_THIS_YEAR

THIS_YEAR, LAST_YEAR, LAST_5_YEARS, 
THIS_FINANCIAL_YEAR, LAST_FINANCIAL_YEAR, LAST_5_FINANCIAL_YEARS</note>
      <width>483</width>
    </notepad>
    <notepad>
      <backgroundcolorblue>251</backgroundcolorblue>
      <backgroundcolorgreen>232</backgroundcolorgreen>
      <backgroundcolorred>201</backgroundcolorred>
      <bordercolorblue>90</bordercolorblue>
      <bordercolorgreen>58</bordercolorgreen>
      <bordercolorred>14</bordercolorred>
      <fontbold>N</fontbold>
      <fontcolorblue>90</fontcolorblue>
      <fontcolorgreen>58</fontcolorgreen>
      <fontcolorred>14</fontcolorred>
      <fontitalic>N</fontitalic>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <height>26</height>
      <xloc>1168</xloc>
      <yloc>128</yloc>
      <note>path to follow when querying yearly</note>
      <width>225</width>
    </notepad>
    <notepad>
      <backgroundcolorblue>251</backgroundcolorblue>
      <backgroundcolorgreen>232</backgroundcolorgreen>
      <backgroundcolorred>201</backgroundcolorred>
      <bordercolorblue>90</bordercolorblue>
      <bordercolorgreen>58</bordercolorgreen>
      <bordercolorred>14</bordercolorred>
      <fontbold>N</fontbold>
      <fontcolorblue>90</fontcolorblue>
      <fontcolorgreen>58</fontcolorgreen>
      <fontcolorred>14</fontcolorred>
      <fontitalic>N</fontitalic>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <height>26</height>
      <xloc>1168</xloc>
      <yloc>288</yloc>
      <note>path to follow when querying monthly</note>
      <width>238</width>
    </notepad>
    <notepad>
      <backgroundcolorblue>23</backgroundcolorblue>
      <backgroundcolorgreen>26</backgroundcolorgreen>
      <backgroundcolorred>248</backgroundcolorred>
      <bordercolorblue>90</bordercolorblue>
      <bordercolorgreen>58</bordercolorgreen>
      <bordercolorred>14</bordercolorred>
      <fontbold>N</fontbold>
      <fontcolorblue>90</fontcolorblue>
      <fontcolorgreen>58</fontcolorgreen>
      <fontcolorred>14</fontcolorred>
      <fontitalic>N</fontitalic>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <height>42</height>
      <xloc>2032</xloc>
      <yloc>384</yloc>
      <note>Please do not remove the Parquet File Output transform!
Only change the Source or Target Fields you want to have in the final table</note>
      <width>459</width>
    </notepad>
    <notepad>
      <backgroundcolorblue>251</backgroundcolorblue>
      <backgroundcolorgreen>232</backgroundcolorgreen>
      <backgroundcolorred>201</backgroundcolorred>
      <bordercolorblue>90</bordercolorblue>
      <bordercolorgreen>58</bordercolorgreen>
      <bordercolorred>14</bordercolorred>
      <fontbold>N</fontbold>
      <fontcolorblue>90</fontcolorblue>
      <fontcolorgreen>58</fontcolorgreen>
      <fontcolorred>14</fontcolorred>
      <fontitalic>N</fontitalic>
      <fontname>.AppleSystemUIFont</fontname>
      <fontsize>13</fontsize>
      <height>26</height>
      <xloc>1232</xloc>
      <yloc>448</yloc>
      <note>path to follow when querying weekly</note>
      <width>231</width>
    </notepad>
  </notepads>
  <order>
    <hop>
      <from>REST client</from>
      <to>Keep only result</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Keep only result</from>
      <to>read data as json</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>read data as json</from>
      <to>remove result field</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Data elements ids</from>
      <to>Group by</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Group by</from>
      <to>join metadata</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>join metadata</from>
      <to>replace data element ids</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>api</from>
      <to>join metadata</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>orgUnitLevel</from>
      <to>join metadata</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>replace data element ids</from>
      <to>replace org unit level</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>replace org unit level</from>
      <to>replace period type</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>replace period type</from>
      <to>REST client</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Data period</from>
      <to>join metadata</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>remove result field</from>
      <to>Convert date correctly switch user defined period</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Convert date correctly switch user defined period</from>
      <to>Get Year</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Convert date correctly switch user defined period</from>
      <to>Seperate year and month</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Seperate year and month</from>
      <to>Map month string to number</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Map month string to number</from>
      <to>create a date format</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>create a date format</from>
      <to>Keep only relevant data</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Keep only relevant data</from>
      <to>Parquet File Output </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Year</from>
      <to>create a date format 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>create a date format 2</from>
      <to>Select values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values</from>
      <to>Parquet File Output </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Convert date correctly switch user defined period</from>
      <to>Extract last day of the week</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Extract last day of the week</from>
      <to>Keep only relevant fields</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Keep only relevant fields</from>
      <to>Parquet File Output </to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <transform>
    <name>Convert date correctly switch user defined period</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cases>
      <case>
        <target_transform>Get Year</target_transform>
        <value>THIS_YEAR</value>
      </case>
      <case>
        <target_transform>Get Year</target_transform>
        <value>LAST_YEAR</value>
      </case>
      <case>
        <target_transform>Get Year</target_transform>
        <value>LAST_5_YEARS</value>
      </case>
      <case>
        <target_transform>Get Year</target_transform>
        <value>THIS_FINANCIAL_YEAR</value>
      </case>
      <case>
        <target_transform>Get Year</target_transform>
        <value>LAST_FINANCIAL_YEAR</value>
      </case>
      <case>
        <target_transform>Get Year</target_transform>
        <value>LAST_5_FINANCIAL_YEARS</value>
      </case>
      <case>
        <target_transform>Seperate year and month</target_transform>
        <value>THIS_MONTH</value>
      </case>
      <case>
        <target_transform>Seperate year and month</target_transform>
        <value>LAST_MONTH</value>
      </case>
      <case>
        <target_transform>Seperate year and month</target_transform>
        <value>LAST_3_MONTHS</value>
      </case>
      <case>
        <target_transform>Seperate year and month</target_transform>
        <value>LAST_6_MONTHS</value>
      </case>
      <case>
        <target_transform>Seperate year and month</target_transform>
        <value>LAST_12_MONTHS</value>
      </case>
      <case>
        <target_transform>Seperate year and month</target_transform>
        <value>MONTHS_THIS_YEAR</value>
      </case>
      <case>
        <target_transform>Extract last day of the week</target_transform>
        <value>THIS_WEEK</value>
      </case>
      <case>
        <target_transform>Extract last day of the week</target_transform>
        <value>LAST_WEEK</value>
      </case>
      <case>
        <target_transform>Extract last day of the week</target_transform>
        <value>LAST_4_WEEKS</value>
      </case>
      <case>
        <target_transform>Extract last day of the week</target_transform>
        <value>LAST_12_WEEKS</value>
      </case>
      <case>
        <target_transform>Extract last day of the week</target_transform>
        <value>LAST_52_WEEKS</value>
      </case>
      <case>
        <target_transform>Extract last day of the week</target_transform>
        <value>WEEKS_THIS_YEAR</value>
      </case>
    </cases>
    <fieldname>period</fieldname>
    <use_contains>Y</use_contains>
    <attributes/>
    <GUI>
      <xloc>1072</xloc>
      <yloc>320</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Data elements ids</name>
    <type>DataGrid</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <data>
      <line>
        <item>JfZvPflUJcW</item>
      </line>
      <line>
        <item>aOZb4Z7QXXH</item>
      </line>
      <line>
        <item>VaKE4oDco0F</item>
      </line>
      <line>
        <item>loBxLh7qzhQ</item>
      </line>
      <line>
        <item>eWdz0xq6azB</item>
      </line>
    </data>
    <fields>
      <field>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
        <name>id</name>
        <type>String</type>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>112</xloc>
      <yloc>336</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Data period</name>
    <type>RowGenerator</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <currency/>
        <decimal/>
        <format/>
        <group/>
        <length>-1</length>
        <name>period</name>
        <nullif>LAST_12_WEEKS</nullif>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
        <type>String</type>
      </field>
    </fields>
    <interval_in_ms>5000</interval_in_ms>
    <last_time_field>FiveSecondsAgo</last_time_field>
    <limit>1</limit>
    <never_ending>N</never_ending>
    <row_time_field>now</row_time_field>
    <attributes/>
    <GUI>
      <xloc>112</xloc>
      <yloc>480</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Extract last day of the week</name>
    <type>Formula</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <formulas>
      <formula>
        <field_name>last_weekday</field_name>
        <formula>RIGHT([date],10)</formula>
        <value_length>-1</value_length>
        <value_precision>-1</value_precision>
        <value_type>2</value_type>
      </formula>
    </formulas>
    <attributes/>
    <GUI>
      <xloc>1248</xloc>
      <yloc>512</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Get Year</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <remove>
        <name>period</name>
      </remove>
      <meta>
        <name>date</name>
        <rename>year</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1136</xloc>
      <yloc>192</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Group by</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <add_linenr>N</add_linenr>
    <all_rows>N</all_rows>
    <directory>${java.io.tmpdir}</directory>
    <fields>
      <field>
        <aggregate>id</aggregate>
        <subject>id</subject>
        <type>CONCAT_STRING</type>
        <valuefield>;</valuefield>
      </field>
    </fields>
    <give_back_row>N</give_back_row>
    <group>
</group>
    <ignore_aggregate>N</ignore_aggregate>
    <prefix>grp</prefix>
    <attributes/>
    <GUI>
      <xloc>288</xloc>
      <yloc>336</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Keep only relevant data</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <remove>
        <name>period</name>
      </remove>
      <remove>
        <name>year</name>
      </remove>
      <remove>
        <name>month</name>
      </remove>
      <remove>
        <name>date</name>
      </remove>
      <meta>
        <name>date_1</name>
        <rename>time</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>data</name>
        <rename>displayName</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>cases</name>
        <rename>cases</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1888</xloc>
      <yloc>320</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Keep only relevant fields</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <remove>
        <name>period</name>
      </remove>
      <remove>
        <name>date</name>
      </remove>
      <meta>
        <name>last_weekday</name>
        <rename>time</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>data</name>
        <rename>displayName</rename>
        <type>None</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1504</xloc>
      <yloc>512</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Keep only result</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>result</name>
      </field>
      <field>
        <name>period</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>800</xloc>
      <yloc>592</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Map month string to number</name>
    <type>ValueMapper</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <field_to_use>month</field_to_use>
    <fields>
      <field>
        <source_value>Janvier</source_value>
        <target_value>01</target_value>
      </field>
      <field>
        <source_value>Février</source_value>
        <target_value>02</target_value>
      </field>
      <field>
        <source_value>Mars</source_value>
        <target_value>03</target_value>
      </field>
      <field>
        <source_value>Avril</source_value>
        <target_value>04</target_value>
      </field>
      <field>
        <source_value>Mai</source_value>
        <target_value>05</target_value>
      </field>
      <field>
        <source_value>Juin</source_value>
        <target_value>06</target_value>
      </field>
      <field>
        <source_value>Juillet</source_value>
        <target_value>07</target_value>
      </field>
      <field>
        <source_value>Août</source_value>
        <target_value>08</target_value>
      </field>
      <field>
        <source_value>Septembre</source_value>
        <target_value>09</target_value>
      </field>
      <field>
        <source_value>Octobre</source_value>
        <target_value>10</target_value>
      </field>
      <field>
        <source_value>Novembre</source_value>
        <target_value>11</target_value>
      </field>
      <field>
        <source_value>Décembre</source_value>
        <target_value>12</target_value>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1520</xloc>
      <yloc>320</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Parquet File Output </name>
    <type>ParquetFileOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compression_codec>UNCOMPRESSED</compression_codec>
    <data_page_size>1048576</data_page_size>
    <dictionary_page_size>1048576</dictionary_page_size>
    <fields>
      <field>
        <source_field>cases</source_field>
        <target_field>cases</target_field>
      </field>
      <field>
        <source_field>orgunit</source_field>
        <target_field>orgunit</target_field>
      </field>
      <field>
        <source_field>displayName</source_field>
        <target_field>displayName</target_field>
      </field>
      <field>
        <source_field>time</source_field>
        <target_field>time</target_field>
      </field>
    </fields>
    <filename_base>filename</filename_base>
    <filename_create_parent_folders>Y</filename_create_parent_folders>
    <filename_datetime_format>yyyyMMdd-HHmmss</filename_datetime_format>
    <filename_ext>parquet</filename_ext>
    <filename_include_copy>N</filename_include_copy>
    <filename_include_date>N</filename_include_date>
    <filename_include_datetime>N</filename_include_datetime>
    <filename_include_split>N</filename_include_split>
    <filename_include_time>N</filename_include_time>
    <filename_split_size>1000000</filename_split_size>
    <row_group_size>20000</row_group_size>
    <version>1.0</version>
    <attributes/>
    <GUI>
      <xloc>2112</xloc>
      <yloc>320</yloc>
    </GUI>
  </transform>
  <transform>
    <name>REST client</name>
    <type>Rest</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <applicationType>TEXT PLAIN</applicationType>
    <method>GET</method>
    <url/>
    <urlInField>Y</urlInField>
    <dynamicMethod>N</dynamicMethod>
    <methodFieldName/>
    <urlField>analytics_url_final</urlField>
    <bodyField/>
    <httpLogin>DIRECTION</httpLogin>
    <readTimeout/>
    <connectionTimeout/>
    <httpPassword>Encrypted 2be98afc86aa7f2a0a310bd4f8cc2fe8c</httpPassword>
    <proxyHost/>
    <proxyPort/>
    <preemptive>N</preemptive>
    <trustStoreFile/>
    <trustStorePassword>Encrypted </trustStorePassword>
    <ignoreSsl>N</ignoreSsl>
    <headers>
      </headers>
    <parameters>
      </parameters>
    <matrixParameters>
      </matrixParameters>
    <result>
      <name>result</name>
      <code/>
      <response_time/>
      <response_header/>
    </result>
    <attributes/>
    <GUI>
      <xloc>688</xloc>
      <yloc>592</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <remove>
        <name>year</name>
      </remove>
      <meta>
        <name>data</name>
        <rename>displayName</rename>
        <type>String</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>date</name>
        <rename>time</rename>
        <type>Date</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>cases</name>
        <rename>cases</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1424</xloc>
      <yloc>192</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Seperate year and month</name>
    <type>Formula</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <formulas>
      <formula>
        <field_name>year</field_name>
        <formula>RIGHT([date],4)</formula>
        <value_length>-1</value_length>
        <value_precision>-1</value_precision>
        <value_type>2</value_type>
      </formula>
      <formula>
        <field_name>month</field_name>
        <formula>TRIM(LEFT([date],SEARCH(" ", [date],1)))</formula>
        <value_length>-1</value_length>
        <value_precision>-1</value_precision>
        <value_type>2</value_type>
      </formula>
    </formulas>
    <attributes/>
    <GUI>
      <xloc>1328</xloc>
      <yloc>320</yloc>
    </GUI>
  </transform>
  <transform>
    <name>api</name>
    <type>DataGrid</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <data>
      <line>
        <item>https://dhis-minsante-cm.org/api/analytics.json?dimension=dx:&lt;data_elements_id>&amp;dimension=pe:&lt;period_type>&amp;dimension=ou:LEVEL-&lt;orgUnitLevel>&amp;outputIdScheme=Name</item>
      </line>
    </data>
    <fields>
      <field>
        <length>-1</length>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
        <name>analytics_url</name>
        <type>String</type>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>416</xloc>
      <yloc>112</yloc>
    </GUI>
  </transform>
  <transform>
    <name>create a date format</name>
    <type>Formula</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <formulas>
      <formula>
        <field_name>date</field_name>
        <formula>EOMONTH(DATE([year],[month],1),0)+Time(23,59,59)</formula>
        <value_length>-1</value_length>
        <value_precision>-1</value_precision>
        <value_type>3</value_type>
      </formula>
    </formulas>
    <attributes/>
    <GUI>
      <xloc>1696</xloc>
      <yloc>320</yloc>
    </GUI>
  </transform>
  <transform>
    <name>create a date format 2</name>
    <type>Formula</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <formulas>
      <formula>
        <field_name>date</field_name>
        <formula>EOMONTH(DATE([year],12,1),0)+Time(23,59,59)</formula>
        <value_length>-1</value_length>
        <value_precision>-1</value_precision>
        <value_type>3</value_type>
      </formula>
    </formulas>
    <attributes/>
    <GUI>
      <xloc>1264</xloc>
      <yloc>192</yloc>
    </GUI>
  </transform>
  <transform>
    <name>join metadata</name>
    <type>JoinRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>out</prefix>
    <cache_size>500</cache_size>
    <main/>
    <compare>
      <condition>
        <conditions>
</conditions>
        <function>=</function>
        <negated>N</negated>
        <operator>-</operator>
      </condition>
    </compare>
    <attributes/>
    <GUI>
      <xloc>416</xloc>
      <yloc>336</yloc>
    </GUI>
  </transform>
  <transform>
    <name>orgUnitLevel</name>
    <type>RowGenerator</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <length>-1</length>
        <name>orgUnitLevel</name>
        <nullif>1</nullif>
        <precision>-1</precision>
        <set_empty_string>N</set_empty_string>
        <type>Integer</type>
      </field>
    </fields>
    <interval_in_ms>5000</interval_in_ms>
    <last_time_field>FiveSecondsAgo</last_time_field>
    <limit>1</limit>
    <never_ending>N</never_ending>
    <row_time_field>now</row_time_field>
    <attributes/>
    <GUI>
      <xloc>128</xloc>
      <yloc>160</yloc>
    </GUI>
  </transform>
  <transform>
    <name>read data as json</name>
    <type>JsonInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <include>N</include>
    <include_field/>
    <rownum>N</rownum>
    <addresultfile>N</addresultfile>
    <readurl>N</readurl>
    <removeSourceField>N</removeSourceField>
    <IsIgnoreEmptyFile>N</IsIgnoreEmptyFile>
    <doNotFailIfNoFile>Y</doNotFailIfNoFile>
    <ignoreMissingPath>Y</ignoreMissingPath>
    <defaultPathLeafToNull>Y</defaultPathLeafToNull>
    <rownum_field/>
    <file>
      <name/>
      <filemask/>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
    </file>
    <fields>
      <field>
        <name>date</name>
        <path>$.rows.*.[1]</path>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>cases</name>
        <path>$.rows.*.[3]</path>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>orgunit</name>
        <path>$.rows.*.[2]</path>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>data</name>
        <path>$.rows.*.[0]</path>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
    </fields>
    <limit>0</limit>
    <IsInFields>Y</IsInFields>
    <IsAFile>N</IsAFile>
    <valueField>result</valueField>
    <shortFileFieldName/>
    <pathFieldName/>
    <hiddenFieldName/>
    <lastModificationTimeFieldName/>
    <uriNameFieldName/>
    <rootUriNameFieldName/>
    <extensionFieldName/>
    <sizeFieldName/>
    <attributes/>
    <GUI>
      <xloc>944</xloc>
      <yloc>592</yloc>
    </GUI>
  </transform>
  <transform>
    <name>remove result field</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <remove>
        <name>result</name>
      </remove>
      <meta>
        <name>cases</name>
        <rename>cases</rename>
        <type>Integer</type>
        <length>-2</length>
        <precision>-2</precision>
        <conversion_mask/>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1072</xloc>
      <yloc>592</yloc>
    </GUI>
  </transform>
  <transform>
    <name>replace data element ids</name>
    <type>ReplaceString</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>analytics_url</in_stream_name>
        <is_unicode>N</is_unicode>
        <out_stream_name>tmp1</out_stream_name>
        <replace_field_by_string>id</replace_field_by_string>
        <replace_string>&lt;data_elements_id></replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>560</xloc>
      <yloc>336</yloc>
    </GUI>
  </transform>
  <transform>
    <name>replace org unit level</name>
    <type>ReplaceString</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>tmp1</in_stream_name>
        <is_unicode>N</is_unicode>
        <out_stream_name>tmp2</out_stream_name>
        <replace_field_by_string>orgUnitLevel</replace_field_by_string>
        <replace_string>&lt;orgUnitLevel></replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>560</xloc>
      <yloc>464</yloc>
    </GUI>
  </transform>
  <transform>
    <name>replace period type</name>
    <type>ReplaceString</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>tmp2</in_stream_name>
        <is_unicode>N</is_unicode>
        <out_stream_name>analytics_url_final</out_stream_name>
        <replace_field_by_string>period</replace_field_by_string>
        <replace_string>&lt;period_type></replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>560</xloc>
      <yloc>592</yloc>
    </GUI>
  </transform>
  <transform_error_handling>
  </transform_error_handling>
  <attributes/>
</pipeline>
